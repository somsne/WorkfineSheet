<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å•å…ƒæ ¼æ ·å¼æ€§èƒ½æµ‹è¯• - WorkfineSheet</title>
  <style>
    :root { --primary: #fa709a; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f7fa; min-height: 100vh; }
    .navbar { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; padding: 16px 24px; display: flex; align-items: center; gap: 16px; }
    .navbar a { color: white; text-decoration: none; opacity: 0.8; }
    .navbar a:hover { opacity: 1; }
    .navbar h1 { font-size: 1.25rem; flex: 1; }
    .container { max-width: 1400px; margin: 0 auto; padding: 24px; }
    .intro { background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .intro h2 { color: #1f2937; margin-bottom: 12px; }
    .intro p { color: #6b7280; line-height: 1.6; }
    .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin: 20px 0; }
    .metric-card { background: #f9fafb; border-radius: 8px; padding: 16px; text-align: center; }
    .metric-card .value { font-size: 1.5rem; font-weight: 700; color: #fa709a; }
    .metric-card .label { font-size: 0.875rem; color: #6b7280; margin-top: 4px; }
    .test-section { background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .test-section h3 { color: #1f2937; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
    .test-section .desc { color: #6b7280; font-size: 0.9rem; margin-bottom: 16px; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 16px; }
    button { padding: 10px 20px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; font-weight: 500; transition: transform 0.2s, box-shadow 0.2s; }
    button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(250, 112, 154, 0.4); }
    button.secondary { background: #e5e7eb; color: #374151; }
    button.extreme { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .result { background: #f9fafb; border-radius: 8px; padding: 16px; font-family: 'Monaco', 'Menlo', monospace; font-size: 0.85rem; line-height: 1.8; white-space: pre-wrap; max-height: 400px; overflow-y: auto; }
    .result:empty::before { content: 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...'; color: #9ca3af; }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; }
    .badge.fast { background: #d1fae5; color: #065f46; }
    .badge.medium { background: #fef3c7; color: #92400e; }
    .badge.slow { background: #fee2e2; color: #991b1b; }
    .progress { width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden; margin: 10px 0; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, #fa709a 0%, #fee140 100%); width: 0%; transition: width 0.3s ease; }
  </style>
</head>
<body>
  <nav class="navbar">
    <a href="index.html">â† è¿”å›</a>
    <h1>ğŸ¨ å•å…ƒæ ¼æ ·å¼æ€§èƒ½æµ‹è¯•</h1>
  </nav>
  
  <div class="container">
    <div class="intro">
      <h2>å•å…ƒæ ¼æ ·å¼æ€§èƒ½æµ‹è¯•</h2>
      <p>æµ‹è¯• SheetModel æ ·å¼ç³»ç»Ÿçš„è¯»å†™æ€§èƒ½ï¼ŒåŒ…æ‹¬æ ·å¼è®¾ç½®ã€æ ·å¼æŸ¥è¯¢ã€è¾¹æ¡†æ“ä½œã€èŒƒå›´æ ·å¼ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
      
      <div class="metrics-grid">
        <div class="metric-card">
          <div class="value" id="metricSetRate">--</div>
          <div class="label">æ ·å¼è®¾ç½®/ç§’</div>
        </div>
        <div class="metric-card">
          <div class="value" id="metricQueryRate">--</div>
          <div class="label">æ ·å¼æŸ¥è¯¢/ç§’</div>
        </div>
        <div class="metric-card">
          <div class="value" id="metricBorderRate">--</div>
          <div class="label">è¾¹æ¡†è®¾ç½®/ç§’</div>
        </div>
        <div class="metric-card">
          <div class="value" id="metricRangeRate">--</div>
          <div class="label">èŒƒå›´æ ·å¼/ç§’</div>
        </div>
      </div>
    </div>
    
    <!-- æ ·å¼è®¾ç½®æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ¨ æµ‹è¯• 1: å•å…ƒæ ¼æ ·å¼è®¾ç½®</h3>
      <p class="desc">æµ‹è¯• SheetModel.setCellStyle çš„åŸºç¡€æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testStyleSet(1000)">1,000 æ¬¡</button>
        <button onclick="testStyleSet(5000)">5,000 æ¬¡</button>
        <button onclick="testStyleSet(10000)">10,000 æ¬¡</button>
        <button onclick="testStyleSet(50000)" class="extreme">âš¡ 50K æ¬¡</button>
      </div>
      <div id="result1" class="result"></div>
    </div>
    
    <!-- æ ·å¼æŸ¥è¯¢æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ” æµ‹è¯• 2: æ ·å¼æŸ¥è¯¢æ€§èƒ½</h3>
      <p class="desc">æµ‹è¯• getCellStyle å’Œ hasCellStyle çš„æŸ¥è¯¢æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testStyleQuery(5000)">5,000 æ¬¡</button>
        <button onclick="testStyleQuery(20000)">20,000 æ¬¡</button>
        <button onclick="testStyleQuery(50000)">50,000 æ¬¡</button>
        <button onclick="testStyleQuery(100000)" class="extreme">ğŸ”¥ 100K æ¬¡</button>
      </div>
      <div id="result2" class="result"></div>
    </div>
    
    <!-- è¾¹æ¡†è®¾ç½®æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ“ æµ‹è¯• 3: è¾¹æ¡†è®¾ç½®æ€§èƒ½</h3>
      <p class="desc">æµ‹è¯• setCellBorder è¾¹æ¡†è®¾ç½®çš„æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testBorderSet(1000)">1,000 æ¬¡</button>
        <button onclick="testBorderSet(5000)">5,000 æ¬¡</button>
        <button onclick="testBorderSet(10000)">10,000 æ¬¡</button>
        <button onclick="testBorderSet(20000)" class="extreme">20,000 æ¬¡</button>
      </div>
      <div id="result3" class="result"></div>
    </div>
    
    <!-- èŒƒå›´æ ·å¼æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ“Š æµ‹è¯• 4: èŒƒå›´æ ·å¼è®¾ç½®</h3>
      <p class="desc">æµ‹è¯• setRangeStyle æ‰¹é‡è®¾ç½®èŒƒå›´æ ·å¼çš„æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testRangeStyle(10, 10)">10Ã—10</button>
        <button onclick="testRangeStyle(50, 50)">50Ã—50</button>
        <button onclick="testRangeStyle(100, 100)">100Ã—100</button>
        <button onclick="testRangeStyle(200, 200)" class="extreme">200Ã—200</button>
      </div>
      <div id="result4" class="result"></div>
    </div>
    
    <!-- å¤æ‚æ ·å¼æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸŒˆ æµ‹è¯• 5: å¤æ‚æ ·å¼ç»„åˆ</h3>
      <p class="desc">æµ‹è¯•è®¾ç½®åŒ…å«å¤šä¸ªå±æ€§çš„å¤æ‚æ ·å¼çš„æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testComplexStyle('simple')">ç®€å•æ ·å¼</button>
        <button onclick="testComplexStyle('medium')">ä¸­ç­‰æ ·å¼</button>
        <button onclick="testComplexStyle('complex')">å¤æ‚æ ·å¼</button>
        <button onclick="testComplexStyle('compare')">å¯¹æ¯”æµ‹è¯•</button>
      </div>
      <div id="result5" class="result"></div>
    </div>
    
    <!-- æ ·å¼æ¸…é™¤æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ§¹ æµ‹è¯• 6: æ ·å¼æ¸…é™¤ä¸å†…å­˜</h3>
      <p class="desc">æµ‹è¯•æ ·å¼æ¸…é™¤æ€§èƒ½å’Œå†…å­˜å›æ”¶æ•ˆç‡</p>
      <div class="controls">
        <button onclick="testStyleClear(5000)">5,000 ä¸ª</button>
        <button onclick="testStyleClear(10000)">10,000 ä¸ª</button>
        <button onclick="testStyleClear(20000)" class="extreme">20,000 ä¸ª</button>
      </div>
      <div id="result6" class="result"></div>
    </div>
  </div>

  <script type="module">
    import { SheetModel } from '../src/lib/SheetModel.ts'
    
    function formatTime(ms) {
      if (ms < 0.001) return `${(ms * 1000000).toFixed(2)} ns`
      if (ms < 1) return `${(ms * 1000).toFixed(2)} Î¼s`
      if (ms < 1000) return `${ms.toFixed(2)} ms`
      return `${(ms / 1000).toFixed(2)} s`
    }
    
    function getSpeedClass(ms, thresholds) {
      if (ms < thresholds.fast) return 'fast'
      if (ms < thresholds.medium) return 'medium'
      return 'slow'
    }
    
    // æµ‹è¯• 1: æ ·å¼è®¾ç½®
    window.testStyleSet = async function(count) {
      const resultDiv = document.getElementById('result1')
      resultDiv.innerHTML = 'â³ åˆ›å»º SheetModel å®ä¾‹...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const cols = 100
      
      // å…ˆå¡«å……æ•°æ®
      for (let i = 0; i < count; i++) {
        model.setValue(Math.floor(i / cols), i % cols, `Cell-${i}`)
      }
      
      const styles = [
        { bold: true },
        { italic: true },
        { bgColor: '#ffcccc' },
        { color: '#0000ff' },
        { textAlign: 'center' }
      ]
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•æ ·å¼è®¾ç½®...'
      await new Promise(r => setTimeout(r, 10))
      
      const setStart = performance.now()
      for (let i = 0; i < count; i++) {
        model.setCellStyle(Math.floor(i / cols), i % cols, styles[i % styles.length])
      }
      const setTime = performance.now() - setStart
      
      const setRate = Math.round(count / (setTime / 1000))
      document.getElementById('metricSetRate').textContent = setRate.toLocaleString()
      
      resultDiv.innerHTML = `
âœ… æ ·å¼è®¾ç½®æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} æ¬¡æ ·å¼è®¾ç½®

â±ï¸ è®¾ç½®æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(setTime, {fast: 100, medium: 500})}">${formatTime(setTime)}</span>
  â€¢ å¹³å‡æ—¶é—´: ${formatTime(setTime / count)}/æ¬¡
  â€¢ è®¾ç½®é€Ÿç‡: <span class="badge fast">${setRate.toLocaleString()} æ¬¡/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${setTime / count < 0.01 ? 'ğŸš€ ä¼˜ç§€ - æ ·å¼è®¾ç½®æå¿«' : 
    setTime / count < 0.05 ? 'âœ… è‰¯å¥½ - æ ·å¼è®¾ç½®æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - æ ·å¼è®¾ç½®è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 2: æ ·å¼æŸ¥è¯¢
    window.testStyleQuery = async function(count) {
      const resultDiv = document.getElementById('result2')
      resultDiv.innerHTML = 'â³ å‡†å¤‡æ•°æ®...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      
      // è®¾ç½®ä¸€äº›æ ·å¼
      for (let i = 0; i < 10000; i++) {
        model.setCellStyle(Math.floor(i / 100), i % 100, { bold: true })
      }
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•æ ·å¼æŸ¥è¯¢...'
      await new Promise(r => setTimeout(r, 10))
      
      const queryStart = performance.now()
      for (let i = 0; i < count; i++) {
        const row = Math.floor(Math.random() * 150)
        const col = Math.floor(Math.random() * 150)
        model.getCellStyle(row, col)
        model.hasCellStyle(row, col)
      }
      const queryTime = performance.now() - queryStart
      
      const queryRate = Math.round(count / (queryTime / 1000))
      document.getElementById('metricQueryRate').textContent = queryRate.toLocaleString()
      
      resultDiv.innerHTML = `
âœ… æ ·å¼æŸ¥è¯¢æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} æ¬¡æŸ¥è¯¢ (getCellStyle + hasCellStyle)

â±ï¸ æŸ¥è¯¢æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(queryTime, {fast: 50, medium: 200})}">${formatTime(queryTime)}</span>
  â€¢ å¹³å‡æ—¶é—´: ${formatTime(queryTime / count)}/æ¬¡
  â€¢ æŸ¥è¯¢é€Ÿç‡: <span class="badge fast">${queryRate.toLocaleString()} æ¬¡/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${queryTime / count < 0.005 ? 'ğŸš€ ä¼˜ç§€ - æ ·å¼æŸ¥è¯¢æå¿«' : 
    queryTime / count < 0.02 ? 'âœ… è‰¯å¥½ - æ ·å¼æŸ¥è¯¢æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - æ ·å¼æŸ¥è¯¢è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 3: è¾¹æ¡†è®¾ç½®
    window.testBorderSet = async function(count) {
      const resultDiv = document.getElementById('result3')
      resultDiv.innerHTML = 'â³ åˆ›å»º SheetModel å®ä¾‹...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const cols = 100
      
      const borders = [
        { top: { style: 'thin', color: '#000000' } },
        { left: { style: 'medium', color: '#ff0000' } },
        { bottom: { style: 'thick', color: '#00ff00' } },
        { right: { style: 'dashed', color: '#0000ff' } },
        { top: { style: 'thin', color: '#000' }, bottom: { style: 'thin', color: '#000' }, left: { style: 'thin', color: '#000' }, right: { style: 'thin', color: '#000' } }
      ]
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•è¾¹æ¡†è®¾ç½®...'
      await new Promise(r => setTimeout(r, 10))
      
      const borderStart = performance.now()
      for (let i = 0; i < count; i++) {
        model.setCellBorder(Math.floor(i / cols), i % cols, borders[i % borders.length])
      }
      const borderTime = performance.now() - borderStart
      
      const borderRate = Math.round(count / (borderTime / 1000))
      document.getElementById('metricBorderRate').textContent = borderRate.toLocaleString()
      
      resultDiv.innerHTML = `
âœ… è¾¹æ¡†è®¾ç½®æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} æ¬¡è¾¹æ¡†è®¾ç½®

â±ï¸ è¾¹æ¡†è®¾ç½®æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(borderTime, {fast: 100, medium: 500})}">${formatTime(borderTime)}</span>
  â€¢ å¹³å‡æ—¶é—´: ${formatTime(borderTime / count)}/æ¬¡
  â€¢ è®¾ç½®é€Ÿç‡: <span class="badge fast">${borderRate.toLocaleString()} æ¬¡/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${borderTime / count < 0.01 ? 'ğŸš€ ä¼˜ç§€ - è¾¹æ¡†è®¾ç½®æå¿«' : 
    borderTime / count < 0.05 ? 'âœ… è‰¯å¥½ - è¾¹æ¡†è®¾ç½®æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - è¾¹æ¡†è®¾ç½®è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 4: èŒƒå›´æ ·å¼
    window.testRangeStyle = async function(rows, cols) {
      const resultDiv = document.getElementById('result4')
      resultDiv.innerHTML = 'â³ åˆ›å»º SheetModel å®ä¾‹...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const count = rows * cols
      
      const style = { bold: true, bgColor: '#ffeecc', textAlign: 'center' }
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•èŒƒå›´æ ·å¼è®¾ç½®...'
      await new Promise(r => setTimeout(r, 10))
      
      const rangeStart = performance.now()
      model.setRangeStyle(0, 0, rows - 1, cols - 1, style)
      const rangeTime = performance.now() - rangeStart
      
      const rangeRate = Math.round(count / (rangeTime / 1000))
      document.getElementById('metricRangeRate').textContent = rangeRate.toLocaleString()
      
      // éªŒè¯
      const styledCount = model.getStyledCellCount()
      
      resultDiv.innerHTML = `
âœ… èŒƒå›´æ ·å¼è®¾ç½®æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${rows} Ã— ${cols} = ${count.toLocaleString()} å•å…ƒæ ¼

â±ï¸ èŒƒå›´æ ·å¼è®¾ç½®æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(rangeTime, {fast: 50, medium: 300})}">${formatTime(rangeTime)}</span>
  â€¢ å¹³å‡æ¯å•å…ƒæ ¼: ${formatTime(rangeTime / count)}
  â€¢ è®¾ç½®é€Ÿç‡: <span class="badge fast">${rangeRate.toLocaleString()} å•å…ƒæ ¼/ç§’</span>

ğŸ“Š éªŒè¯:
  â€¢ å·²è®¾ç½®æ ·å¼å•å…ƒæ ¼æ•°: ${styledCount.toLocaleString()}

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${rangeTime < 100 ? 'ğŸš€ ä¼˜ç§€ - èŒƒå›´æ ·å¼è®¾ç½®æå¿«' : 
    rangeTime < 500 ? 'âœ… è‰¯å¥½ - èŒƒå›´æ ·å¼è®¾ç½®æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - èŒƒå›´æ ·å¼è®¾ç½®è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 5: å¤æ‚æ ·å¼
    window.testComplexStyle = async function(type) {
      const resultDiv = document.getElementById('result5')
      const count = 5000
      
      const styles = {
        simple: { bold: true },
        medium: { bold: true, italic: true, bgColor: '#ffcccc', color: '#0000ff' },
        complex: { 
          bold: true, 
          italic: true, 
          underline: 'single',
          strikethrough: true,
          bgColor: '#ffcccc', 
          color: '#0000ff',
          fontSize: 14,
          fontFamily: 'Arial',
          textAlign: 'center',
          verticalAlign: 'middle',
          wrapText: true
        }
      }
      
      if (type === 'compare') {
        resultDiv.innerHTML = 'â³ å¯¹æ¯”æµ‹è¯•ä¸­...'
        await new Promise(r => setTimeout(r, 10))
        
        const results = {}
        
        for (const [name, style] of Object.entries(styles)) {
          const model = new SheetModel()
          const start = performance.now()
          for (let i = 0; i < count; i++) {
            model.setCellStyle(Math.floor(i / 100), i % 100, style)
          }
          results[name] = { 
            time: performance.now() - start,
            props: Object.keys(style).length
          }
        }
        
        resultDiv.innerHTML = `
âœ… å¤æ‚æ ·å¼å¯¹æ¯”æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} å•å…ƒæ ¼ Ã— 3 ç§æ ·å¼

<table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
<tr style="background: #f9fafb;"><th style="padding: 10px; text-align: left;">æ ·å¼ç±»å‹</th><th>å±æ€§æ•°</th><th>è®¾ç½®æ—¶é—´</th><th>é€Ÿç‡</th></tr>
<tr>
  <td style="padding: 10px;">ç®€å•æ ·å¼</td>
  <td>${results.simple.props} ä¸ª</td>
  <td><span class="badge fast">${formatTime(results.simple.time)}</span></td>
  <td>${Math.round(count / (results.simple.time / 1000)).toLocaleString()}/ç§’</td>
</tr>
<tr>
  <td style="padding: 10px;">ä¸­ç­‰æ ·å¼</td>
  <td>${results.medium.props} ä¸ª</td>
  <td><span class="badge fast">${formatTime(results.medium.time)}</span></td>
  <td>${Math.round(count / (results.medium.time / 1000)).toLocaleString()}/ç§’</td>
</tr>
<tr>
  <td style="padding: 10px;">å¤æ‚æ ·å¼</td>
  <td>${results.complex.props} ä¸ª</td>
  <td><span class="badge ${getSpeedClass(results.complex.time, {fast: 100, medium: 300})}">${formatTime(results.complex.time)}</span></td>
  <td>${Math.round(count / (results.complex.time / 1000)).toLocaleString()}/ç§’</td>
</tr>
</table>

ğŸ“ˆ åˆ†æ:
  â€¢ æ ·å¼å±æ€§æ•°é‡å¯¹æ€§èƒ½å½±å“: ${((results.complex.time / results.simple.time - 1) * 100).toFixed(1)}% å¢å¹…
  â€¢ SheetModel ä½¿ç”¨å¯¹è±¡åˆå¹¶ï¼Œå¤æ‚æ ·å¼å¼€é”€å¯æ§
`
      } else {
        const model = new SheetModel()
        const style = styles[type]
        
        resultDiv.innerHTML = `â³ æµ‹è¯• ${type === 'simple' ? 'ç®€å•' : type === 'medium' ? 'ä¸­ç­‰' : 'å¤æ‚'} æ ·å¼...`
        await new Promise(r => setTimeout(r, 10))
        
        const start = performance.now()
        for (let i = 0; i < count; i++) {
          model.setCellStyle(Math.floor(i / 100), i % 100, style)
        }
        const time = performance.now() - start
        
        resultDiv.innerHTML = `
âœ… ${type === 'simple' ? 'ç®€å•' : type === 'medium' ? 'ä¸­ç­‰' : 'å¤æ‚'}æ ·å¼æµ‹è¯•å®Œæˆ

ğŸ“Š æ ·å¼å±æ€§æ•°: ${Object.keys(style).length} ä¸ª
ğŸ“Š è®¾ç½®æ—¶é—´: <span class="badge fast">${formatTime(time)}</span>
  â€¢ è®¾ç½®é€Ÿç‡: ${Math.round(count / (time / 1000)).toLocaleString()} å•å…ƒæ ¼/ç§’
`
      }
    }
    
    // æµ‹è¯• 6: æ ·å¼æ¸…é™¤
    window.testStyleClear = async function(count) {
      const resultDiv = document.getElementById('result6')
      resultDiv.innerHTML = 'â³ è®¾ç½®æ ·å¼...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const cols = 100
      
      // è®¾ç½®æ ·å¼
      for (let i = 0; i < count; i++) {
        model.setCellStyle(Math.floor(i / cols), i % cols, { bold: true, bgColor: '#ffcccc' })
      }
      
      const countBefore = model.getStyledCellCount()
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•æ ·å¼æ¸…é™¤...'
      await new Promise(r => setTimeout(r, 10))
      
      const clearStart = performance.now()
      for (let i = 0; i < count; i++) {
        model.clearCellStyle(Math.floor(i / cols), i % cols)
      }
      const clearTime = performance.now() - clearStart
      
      const countAfter = model.getStyledCellCount()
      const clearRate = Math.round(count / (clearTime / 1000))
      
      resultDiv.innerHTML = `
âœ… æ ·å¼æ¸…é™¤æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} ä¸ªå•å…ƒæ ¼

â±ï¸ æ¸…é™¤æ€§èƒ½:
  â€¢ æ¸…é™¤æ—¶é—´: <span class="badge ${getSpeedClass(clearTime, {fast: 50, medium: 200})}">${formatTime(clearTime)}</span>
  â€¢ å¹³å‡æ¯å•å…ƒæ ¼: ${formatTime(clearTime / count)}
  â€¢ æ¸…é™¤é€Ÿç‡: <span class="badge fast">${clearRate.toLocaleString()} æ¬¡/ç§’</span>

ğŸ“Š å†…å­˜éªŒè¯:
  â€¢ æ¸…é™¤å‰æ ·å¼æ•°: ${countBefore.toLocaleString()}
  â€¢ æ¸…é™¤åæ ·å¼æ•°: ${countAfter.toLocaleString()}
  â€¢ å†…å­˜é‡Šæ”¾: ${countBefore === countAfter ? 'âŒ æœªé‡Šæ”¾' : 'âœ… å·²é‡Šæ”¾'}

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${clearTime / count < 0.005 ? 'ğŸš€ ä¼˜ç§€ - æ ·å¼æ¸…é™¤æå¿«' : 
    clearTime / count < 0.02 ? 'âœ… è‰¯å¥½ - æ ·å¼æ¸…é™¤æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - æ ·å¼æ¸…é™¤è¾ƒæ…¢'}
`
    }
  </script>
</body>
</html>
