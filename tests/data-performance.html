<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ•°æ®æ“ä½œæ€§èƒ½æµ‹è¯• - WorkfineSheet</title>
  <style>
    :root { --primary: #4facfe; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f7fa; min-height: 100vh; }
    .navbar { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 16px 24px; display: flex; align-items: center; gap: 16px; }
    .navbar a { color: white; text-decoration: none; opacity: 0.8; }
    .navbar a:hover { opacity: 1; }
    .navbar h1 { font-size: 1.25rem; flex: 1; }
    .container { max-width: 1400px; margin: 0 auto; padding: 24px; }
    .intro { background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .intro h2 { color: #1f2937; margin-bottom: 12px; }
    .intro p { color: #6b7280; line-height: 1.6; }
    .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin: 20px 0; }
    .metric-card { background: #f9fafb; border-radius: 8px; padding: 16px; text-align: center; }
    .metric-card .value { font-size: 1.5rem; font-weight: 700; color: #00b4d8; }
    .metric-card .label { font-size: 0.875rem; color: #6b7280; margin-top: 4px; }
    .test-section { background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .test-section h3 { color: #1f2937; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
    .test-section .desc { color: #6b7280; font-size: 0.9rem; margin-bottom: 16px; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 16px; }
    button { padding: 10px 20px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; font-weight: 500; transition: transform 0.2s, box-shadow 0.2s; }
    button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(79, 172, 254, 0.4); }
    button.secondary { background: #e5e7eb; color: #374151; }
    button.extreme { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
    .result { background: #f9fafb; border-radius: 8px; padding: 16px; font-family: 'Monaco', 'Menlo', monospace; font-size: 0.85rem; line-height: 1.8; white-space: pre-wrap; max-height: 400px; overflow-y: auto; }
    .result:empty::before { content: 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...'; color: #9ca3af; }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; }
    .badge.fast { background: #d1fae5; color: #065f46; }
    .badge.medium { background: #fef3c7; color: #92400e; }
    .badge.slow { background: #fee2e2; color: #991b1b; }
    .progress { width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden; margin: 10px 0; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%); width: 0%; transition: width 0.3s ease; }
  </style>
</head>
<body>
  <nav class="navbar">
    <a href="index.html">â† è¿”å›</a>
    <h1>ğŸ’¾ æ•°æ®æ“ä½œæ€§èƒ½æµ‹è¯•</h1>
  </nav>
  
  <div class="container">
    <div class="intro">
      <h2>æ•°æ®æ“ä½œæ€§èƒ½æµ‹è¯•</h2>
      <p>æµ‹è¯• SheetModel æ•°æ®å±‚çš„è¯»å†™æ€§èƒ½ï¼ŒåŒ…æ‹¬å•å…ƒæ ¼æ“ä½œã€æ‰¹é‡åŠ è½½ã€æ ·å¼è®¾ç½®ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
      
      <div class="metrics-grid">
        <div class="metric-card">
          <div class="value" id="metricReadRate">--</div>
          <div class="label">è¯»å–é€Ÿç‡/ç§’</div>
        </div>
        <div class="metric-card">
          <div class="value" id="metricWriteRate">--</div>
          <div class="label">å†™å…¥é€Ÿç‡/ç§’</div>
        </div>
        <div class="metric-card">
          <div class="value" id="metricStyleRate">--</div>
          <div class="label">æ ·å¼è®¾ç½®/ç§’</div>
        </div>
        <div class="metric-card">
          <div class="value" id="metricDataSize">--</div>
          <div class="label">æ•°æ®é‡</div>
        </div>
      </div>
    </div>
    
    <!-- å•å…ƒæ ¼è¯»å†™æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ“ æµ‹è¯• 1: å•å…ƒæ ¼è¯»å†™é€Ÿåº¦</h3>
      <p class="desc">æµ‹è¯• SheetModel.getValue/setValue çš„åŸºç¡€æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testCellReadWrite(1000)">1,000 æ¬¡</button>
        <button onclick="testCellReadWrite(10000)">10,000 æ¬¡</button>
        <button onclick="testCellReadWrite(100000)">100,000 æ¬¡</button>
        <button onclick="testCellReadWrite(500000)" class="extreme">âš¡ 500K æ¬¡</button>
      </div>
      <div id="result1" class="result"></div>
    </div>
    
    <!-- æ‰¹é‡æ•°æ®åŠ è½½ -->
    <div class="test-section">
      <h3>ğŸ“Š æµ‹è¯• 2: æ‰¹é‡æ•°æ®åŠ è½½</h3>
      <p class="desc">æµ‹è¯•å¤§é‡æ•°æ®çš„åŠ è½½æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testBatchLoad(1000)">1,000 å•å…ƒæ ¼</button>
        <button onclick="testBatchLoad(10000)">10,000 å•å…ƒæ ¼</button>
        <button onclick="testBatchLoad(50000)">50,000 å•å…ƒæ ¼</button>
        <button onclick="testBatchLoad(100000)" class="extreme">ğŸ”¥ 100K å•å…ƒæ ¼</button>
      </div>
      <div class="progress" id="progress2"><div class="progress-bar" id="progressBar2"></div></div>
      <div id="result2" class="result"></div>
    </div>
    
    <!-- æ ·å¼æ‰¹é‡è®¾ç½® -->
    <div class="test-section">
      <h3>ğŸ¨ æµ‹è¯• 3: æ ·å¼æ‰¹é‡è®¾ç½®</h3>
      <p class="desc">æµ‹è¯• setCellStyle æ‰¹é‡è®¾ç½®æ ·å¼çš„æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testStyleBatch(100)">100 å•å…ƒæ ¼</button>
        <button onclick="testStyleBatch(1000)">1,000 å•å…ƒæ ¼</button>
        <button onclick="testStyleBatch(5000)">5,000 å•å…ƒæ ¼</button>
        <button onclick="testStyleBatch(10000)" class="extreme">10,000 å•å…ƒæ ¼</button>
      </div>
      <div id="result3" class="result"></div>
    </div>
    
    <!-- å…¬å¼å•å…ƒæ ¼æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ“ æµ‹è¯• 4: å…¬å¼å•å…ƒæ ¼æ€§èƒ½</h3>
      <p class="desc">æµ‹è¯• FormulaSheet è®¾ç½®å’Œè·å–å…¬å¼çš„æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testFormulaCells(100)">100 ä¸ªå…¬å¼</button>
        <button onclick="testFormulaCells(500)">500 ä¸ªå…¬å¼</button>
        <button onclick="testFormulaCells(1000)">1,000 ä¸ªå…¬å¼</button>
        <button onclick="testFormulaCells(2000)" class="extreme">2,000 ä¸ªå…¬å¼</button>
      </div>
      <div id="result4" class="result"></div>
    </div>
    
    <!-- ç¨€ç–æ•°æ®æµ‹è¯• -->
    <div class="test-section">
      <h3>ğŸ—‚ï¸ æµ‹è¯• 5: ç¨€ç–æ•°æ®å­˜å‚¨æ•ˆç‡</h3>
      <p class="desc">æµ‹è¯•ç¨€ç–å­˜å‚¨æ¨¡å‹åœ¨ä¸åŒæ•°æ®åˆ†å¸ƒä¸‹çš„æ€§èƒ½</p>
      <div class="controls">
        <button onclick="testSparseData('dense')">è¿ç»­å­˜å‚¨</button>
        <button onclick="testSparseData('sparse')">ç¨€ç–å­˜å‚¨</button>
        <button onclick="testSparseData('compare')">å¯¹æ¯”æµ‹è¯•</button>
      </div>
      <div id="result5" class="result"></div>
    </div>
  </div>

  <script type="module">
    import { SheetModel } from '../src/lib/SheetModel.ts'
    import { FormulaSheet } from '../src/lib/FormulaSheet.ts'
    
    function formatTime(ms) {
      if (ms < 0.001) return `${(ms * 1000000).toFixed(2)} ns`
      if (ms < 1) return `${(ms * 1000).toFixed(2)} Î¼s`
      if (ms < 1000) return `${ms.toFixed(2)} ms`
      return `${(ms / 1000).toFixed(2)} s`
    }
    
    function getSpeedClass(ms, thresholds) {
      if (ms < thresholds.fast) return 'fast'
      if (ms < thresholds.medium) return 'medium'
      return 'slow'
    }
    
    // æµ‹è¯• 1: å•å…ƒæ ¼è¯»å†™
    window.testCellReadWrite = async function(count) {
      const resultDiv = document.getElementById('result1')
      resultDiv.innerHTML = 'â³ åˆ›å»º SheetModel å®ä¾‹...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const cols = 100
      
      // å†™å…¥æµ‹è¯•
      resultDiv.innerHTML = 'â³ æµ‹è¯•å†™å…¥...'
      const writeStart = performance.now()
      for (let i = 0; i < count; i++) {
        const r = Math.floor(i / cols)
        const c = i % cols
        model.setValue(r, c, `Value-${i}`)
      }
      const writeTime = performance.now() - writeStart
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•è¯»å–...'
      await new Promise(r => setTimeout(r, 10))
      
      // è¯»å–æµ‹è¯•
      const readStart = performance.now()
      for (let i = 0; i < count; i++) {
        const r = Math.floor(i / cols)
        const c = i % cols
        const val = model.getValue(r, c)
      }
      const readTime = performance.now() - readStart
      
      const writeRate = Math.round(count / (writeTime / 1000))
      const readRate = Math.round(count / (readTime / 1000))
      
      document.getElementById('metricReadRate').textContent = readRate.toLocaleString()
      document.getElementById('metricWriteRate').textContent = writeRate.toLocaleString()
      
      resultDiv.innerHTML = `
âœ… å•å…ƒæ ¼è¯»å†™æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} æ¬¡æ“ä½œ

â±ï¸ å†™å…¥æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(writeTime, {fast: 100, medium: 500})}">${formatTime(writeTime)}</span>
  â€¢ å¹³å‡æ—¶é—´: ${formatTime(writeTime / count)}/æ¬¡
  â€¢ å†™å…¥é€Ÿç‡: <span class="badge fast">${writeRate.toLocaleString()} æ¬¡/ç§’</span>

â±ï¸ è¯»å–æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(readTime, {fast: 50, medium: 200})}">${formatTime(readTime)}</span>
  â€¢ å¹³å‡æ—¶é—´: ${formatTime(readTime / count)}/æ¬¡
  â€¢ è¯»å–é€Ÿç‡: <span class="badge fast">${readRate.toLocaleString()} æ¬¡/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${writeTime / count < 0.01 ? 'ğŸš€ ä¼˜ç§€ - è¯»å†™æ€§èƒ½æä½³' : 
    writeTime / count < 0.1 ? 'âœ… è‰¯å¥½ - è¯»å†™æ€§èƒ½æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - è¯»å†™æ€§èƒ½è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 2: æ‰¹é‡æ•°æ®åŠ è½½
    window.testBatchLoad = async function(count) {
      const resultDiv = document.getElementById('result2')
      const progressBar = document.getElementById('progressBar2')
      
      resultDiv.innerHTML = 'â³ åˆ›å»º SheetModel å®ä¾‹...'
      progressBar.style.width = '0%'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const rows = Math.ceil(Math.sqrt(count))
      const cols = Math.ceil(count / rows)
      
      const loadStart = performance.now()
      let loaded = 0
      
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols && loaded < count; c++) {
          model.setValue(r, c, `R${r}C${c}`)
          loaded++
        }
        if (r % 50 === 0) {
          progressBar.style.width = `${(r / rows * 100)}%`
          await new Promise(resolve => setTimeout(resolve, 0))
        }
      }
      const loadTime = performance.now() - loadStart
      
      progressBar.style.width = '100%'
      
      const loadRate = Math.round(count / (loadTime / 1000))
      document.getElementById('metricDataSize').textContent = `${count.toLocaleString()}`
      
      resultDiv.innerHTML = `
âœ… æ‰¹é‡æ•°æ®åŠ è½½æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${rows} è¡Œ Ã— ${cols} åˆ— = ${count.toLocaleString()} å•å…ƒæ ¼

â±ï¸ åŠ è½½æ€§èƒ½:
  â€¢ åŠ è½½æ—¶é—´: <span class="badge ${getSpeedClass(loadTime, {fast: 200, medium: 1000})}">${formatTime(loadTime)}</span>
  â€¢ å¹³å‡æ¯å•å…ƒæ ¼: ${formatTime(loadTime / count)}
  â€¢ åŠ è½½é€Ÿç‡: <span class="badge fast">${loadRate.toLocaleString()} å•å…ƒæ ¼/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${loadTime < 200 ? 'ğŸš€ ä¼˜ç§€ - å¤§æ•°æ®åŠ è½½æå¿«' : 
    loadTime < 1000 ? 'âœ… è‰¯å¥½ - å¤§æ•°æ®åŠ è½½æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - å¤§æ•°æ®åŠ è½½è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 3: æ ·å¼æ‰¹é‡è®¾ç½®
    window.testStyleBatch = async function(count) {
      const resultDiv = document.getElementById('result3')
      resultDiv.innerHTML = 'â³ åˆ›å»º SheetModel å¹¶å¡«å……æ•°æ®...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const rows = Math.ceil(Math.sqrt(count))
      const cols = Math.ceil(count / rows)
      
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          model.setValue(r, c, `Cell-${r}-${c}`)
        }
      }
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•æ ·å¼è®¾ç½®...'
      await new Promise(r => setTimeout(r, 10))
      
      const styles = [
        { bgColor: '#ffcccc', fontWeight: 'bold' },
        { bgColor: '#ccffcc', fontStyle: 'italic' },
        { bgColor: '#ccccff', textAlign: 'center' },
      ]
      
      const styleStart = performance.now()
      let styleCount = 0
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          model.setCellStyle(r, c, styles[styleCount % styles.length])
          styleCount++
        }
      }
      const styleTime = performance.now() - styleStart
      
      const styleRate = Math.round(count / (styleTime / 1000))
      document.getElementById('metricStyleRate').textContent = styleRate.toLocaleString()
      
      resultDiv.innerHTML = `
âœ… æ ·å¼æ‰¹é‡è®¾ç½®æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${rows} è¡Œ Ã— ${cols} åˆ— = ${count.toLocaleString()} å•å…ƒæ ¼

â±ï¸ æ ·å¼è®¾ç½®æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(styleTime, {fast: 100, medium: 500})}">${formatTime(styleTime)}</span>
  â€¢ å¹³å‡æ¯å•å…ƒæ ¼: ${formatTime(styleTime / count)}
  â€¢ è®¾ç½®é€Ÿç‡: <span class="badge fast">${styleRate.toLocaleString()} å•å…ƒæ ¼/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${styleTime / count < 0.05 ? 'ğŸš€ ä¼˜ç§€ - æ ·å¼è®¾ç½®æå¿«' : 
    styleTime / count < 0.2 ? 'âœ… è‰¯å¥½ - æ ·å¼è®¾ç½®æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - æ ·å¼è®¾ç½®è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 4: å…¬å¼å•å…ƒæ ¼
    window.testFormulaCells = async function(count) {
      const resultDiv = document.getElementById('result4')
      resultDiv.innerHTML = 'â³ åˆ›å»º FormulaSheet å®ä¾‹...'
      
      await new Promise(r => setTimeout(r, 10))
      
      const model = new SheetModel()
      const sheet = new FormulaSheet(model)
      
      // å…ˆå¡«å……åŸºç¡€æ•°æ®
      for (let r = 0; r < 100; r++) {
        for (let c = 0; c < 10; c++) {
          model.setValue(r, c, r * 10 + c)
        }
      }
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•å…¬å¼è®¾ç½®...'
      await new Promise(r => setTimeout(r, 10))
      
      const formulas = ['=A1+B1', '=SUM(A1:A10)', '=AVERAGE(B1:B5)', '=A1*2+B1*3']
      
      const setStart = performance.now()
      for (let i = 0; i < count; i++) {
        const r = Math.floor(i / 50) + 100
        const c = (i % 50) + 10
        sheet.setValue(r, c, formulas[i % formulas.length])
      }
      const setTime = performance.now() - setStart
      
      resultDiv.innerHTML = 'â³ æµ‹è¯•å…¬å¼è·å–...'
      await new Promise(r => setTimeout(r, 10))
      
      const getStart = performance.now()
      for (let i = 0; i < count; i++) {
        const r = Math.floor(i / 50) + 100
        const c = (i % 50) + 10
        sheet.getValue(r, c)
      }
      const getTime = performance.now() - getStart
      
      const setRate = Math.round(count / (setTime / 1000))
      const getRate = Math.round(count / (getTime / 1000))
      
      resultDiv.innerHTML = `
âœ… å…¬å¼å•å…ƒæ ¼æ€§èƒ½æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® FormulaSheet)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${count.toLocaleString()} ä¸ªå…¬å¼

â±ï¸ å…¬å¼è®¾ç½®æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(setTime, {fast: 200, medium: 1000})}">${formatTime(setTime)}</span>
  â€¢ å¹³å‡æ¯å…¬å¼: ${formatTime(setTime / count)}
  â€¢ è®¾ç½®é€Ÿç‡: <span class="badge fast">${setRate.toLocaleString()} å…¬å¼/ç§’</span>

â±ï¸ å…¬å¼è·å–æ€§èƒ½:
  â€¢ æ€»æ—¶é—´: <span class="badge ${getSpeedClass(getTime, {fast: 100, medium: 500})}">${formatTime(getTime)}</span>
  â€¢ å¹³å‡æ¯å…¬å¼: ${formatTime(getTime / count)}
  â€¢ è·å–é€Ÿç‡: <span class="badge fast">${getRate.toLocaleString()} å…¬å¼/ç§’</span>

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  ${setTime / count < 1 ? 'ğŸš€ ä¼˜ç§€ - å…¬å¼å¤„ç†æå¿«' : 
    setTime / count < 5 ? 'âœ… è‰¯å¥½ - å…¬å¼å¤„ç†æ­£å¸¸' : 
    'âš ï¸ éœ€ä¼˜åŒ– - å…¬å¼å¤„ç†è¾ƒæ…¢'}
`
    }
    
    // æµ‹è¯• 5: ç¨€ç–æ•°æ®å­˜å‚¨
    window.testSparseData = async function(type) {
      const resultDiv = document.getElementById('result5')
      const cellCount = 10000
      
      if (type === 'compare') {
        resultDiv.innerHTML = 'â³ å¯¹æ¯”æµ‹è¯•ä¸­...'
        await new Promise(r => setTimeout(r, 10))
        
        const results = {}
        
        // è¿ç»­å­˜å‚¨
        const denseModel = new SheetModel()
        const denseStart = performance.now()
        for (let i = 0; i < cellCount; i++) {
          denseModel.setValue(Math.floor(i / 100), i % 100, `D-${i}`)
        }
        results.dense = { time: performance.now() - denseStart }
        
        // ç¨€ç–å­˜å‚¨
        const sparseModel = new SheetModel()
        const sparseStart = performance.now()
        for (let i = 0; i < cellCount; i++) {
          sparseModel.setValue(Math.floor(Math.random() * 1000), Math.floor(Math.random() * 1000), `S-${i}`)
        }
        results.sparse = { time: performance.now() - sparseStart }
        
        resultDiv.innerHTML = `
âœ… ç¨€ç–å­˜å‚¨å¯¹æ¯”æµ‹è¯•å®Œæˆ (ä½¿ç”¨çœŸå® SheetModel)

ğŸ“Š æµ‹è¯•è§„æ¨¡: ${cellCount.toLocaleString()} å•å…ƒæ ¼

<table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
<tr style="background: #f9fafb;"><th style="padding: 10px; text-align: left;">å­˜å‚¨æ–¹å¼</th><th>èŒƒå›´</th><th>å†™å…¥æ—¶é—´</th></tr>
<tr>
  <td style="padding: 10px;">è¿ç»­å­˜å‚¨</td>
  <td>100Ã—100</td>
  <td><span class="badge fast">${formatTime(results.dense.time)}</span></td>
</tr>
<tr>
  <td style="padding: 10px;">ç¨€ç–å­˜å‚¨</td>
  <td>1000Ã—1000 (éšæœº)</td>
  <td><span class="badge fast">${formatTime(results.sparse.time)}</span></td>
</tr>
</table>

ğŸ“ˆ åˆ†æ:
  â€¢ SheetModel ä½¿ç”¨ Map ç»“æ„ï¼Œå¯¹ç¨€ç–å’Œè¿ç»­æ•°æ®éƒ½æœ‰è‰¯å¥½æ€§èƒ½
  â€¢ å†™å…¥æ€§èƒ½å·®å¼‚: ${((results.sparse.time / results.dense.time - 1) * 100).toFixed(1)}%
`
      } else {
        const model = new SheetModel()
        const isDense = type === 'dense'
        
        resultDiv.innerHTML = `â³ æµ‹è¯• ${isDense ? 'è¿ç»­' : 'ç¨€ç–'} å­˜å‚¨...`
        await new Promise(r => setTimeout(r, 10))
        
        const writeStart = performance.now()
        for (let i = 0; i < cellCount; i++) {
          const r = isDense ? Math.floor(i / 100) : Math.floor(Math.random() * 1000)
          const c = isDense ? i % 100 : Math.floor(Math.random() * 1000)
          model.setValue(r, c, `${type}-${i}`)
        }
        const writeTime = performance.now() - writeStart
        
        resultDiv.innerHTML = `
âœ… ${isDense ? 'è¿ç»­' : 'ç¨€ç–'}å­˜å‚¨æµ‹è¯•å®Œæˆ

ğŸ“Š å†™å…¥æ—¶é—´: <span class="badge fast">${formatTime(writeTime)}</span>
  â€¢ å†™å…¥é€Ÿç‡: ${Math.round(cellCount / (writeTime / 1000)).toLocaleString()} å•å…ƒæ ¼/ç§’
`
      }
    }
  </script>
</body>
</html>
