# 边框功能使用指南

## 功能概述

WorkfineSheet 现已支持完整的单元格边框设置功能，包括：

- ✅ 所有边框 - 为选区内每个单元格添加四边边框
- ✅ 外边框 - 仅为选区外围添加边框
- ✅ 上/下/左/右边框 - 单独设置某一边的边框
- ✅ 清除边框 - 移除选区内所有边框
- ✅ 边框样式 - 6种样式可选（细线、中等、粗线、虚线、点线、双线）
- ✅ 边框颜色 - 自定义边框颜色
- ✅ 暗黑模式支持 - 自动适配暗黑主题

## 使用方法

### 1. 打开边框菜单

在工具栏中找到边框按钮（▦ 图标），点击打开边框设置菜单。

### 2. 选择边框类型

菜单中提供以下边框选项：

| 选项 | 图标 | 说明 |
|------|------|------|
| 所有边框 | ⊞ | 为选区内每个单元格添加完整的四边边框，类似表格效果 |
| 外边框 | ▢ | 只在选区最外围添加边框，内部单元格无边框 |
| 上边框 | ⎺ | 为选区顶部单元格添加上边框 |
| 下边框 | ⎽ | 为选区底部单元格添加下边框 |
| 左边框 | ⎸ | 为选区左侧单元格添加左边框 |
| 右边框 | ⎹ | 为选区右侧单元格添加右边框 |
| 清除边框 | ○ | 移除选区内所有边框设置 |

### 3. 自定义边框样式

在菜单底部可以设置：

**边框样式下拉框**：
- 细线 (1px 实线)
- 中等 (2px 实线)
- 粗线 (3px 实线)
- 虚线 (1px 虚线)
- 点线 (1px 点线)
- 双线 (3px 双线效果)

**边框颜色选择器**：
- 点击颜色选择器可以自定义边框颜色
- 默认颜色为黑色 (#000000)

## 使用场景

### 场景 1: 创建表格

1. 选择一个单元格范围（如 A1:D5）
2. 点击边框按钮打开菜单
3. 选择"所有边框"
4. 效果：选区内每个单元格都有完整的边框，形成表格效果

### 场景 2: 强调区域

1. 选择需要强调的区域（如 B2:C4）
2. 点击边框按钮打开菜单
3. 在样式下拉框中选择"粗线"
4. 在颜色选择器中选择红色 (#FF0000)
5. 选择"外边框"
6. 效果：选区外围有一圈红色粗边框

### 场景 3: 分隔线

1. 选择需要添加分隔线的单元格范围
2. 点击边框按钮打开菜单
3. 选择"下边框"
4. 效果：在选区底部添加一条分隔线

### 场景 4: 虚线边框

1. 选择单元格范围
2. 点击边框按钮打开菜单
3. 在样式下拉框中选择"虚线"
4. 选择"所有边框"
5. 效果：单元格边框显示为虚线样式

## API 使用

如果需要通过代码设置边框，可以使用以下 API：

### 设置单个单元格边框

```typescript
// 获取 Sheet API
const api = sheetRef.value

// 设置单个单元格的完整边框
api.setCellBorder(0, 0, {
  top: { style: 'thin', color: '#000000' },
  right: { style: 'thin', color: '#000000' },
  bottom: { style: 'thin', color: '#000000' },
  left: { style: 'thin', color: '#000000' }
})

// 只设置某一边的边框
api.setCellBorder(1, 1, {
  bottom: { style: 'medium', color: '#FF0000' }
})
```

### 设置范围边框

```typescript
// 为范围内所有单元格设置完整边框
api.setAllBorders(
  0, 0,  // startRow, startCol
  5, 5,  // endRow, endCol
  { style: 'thin', color: '#000000' }
)

// 只为范围外围设置边框
api.setOuterBorder(
  0, 0,  // startRow, startCol
  5, 5,  // endRow, endCol
  { style: 'thick', color: '#0000FF' }
)

// 清除范围内所有边框
api.clearAllBorders(0, 0, 5, 5)
```

### 边框样式类型

```typescript
type BorderStyle = 
  | 'none'        // 无边框
  | 'thin'        // 细线 (1px)
  | 'medium'      // 中等线 (2px)
  | 'thick'       // 粗线 (3px)
  | 'dashed'      // 虚线
  | 'dotted'      // 点线
  | 'double'      // 双线

interface BorderEdge {
  style: BorderStyle
  color?: string  // 默认 #000000
  width?: number  // 自定义宽度，覆盖 style 预设
}
```

## 快捷操作

1. **快速添加表格边框**：
   - 选择范围 → 点击边框按钮 → 选择"所有边框"

2. **快速清除边框**：
   - 选择范围 → 点击边框按钮 → 选择"清除边框"

3. **自定义边框样式**：
   - 先在菜单中设置样式和颜色
   - 再选择需要的边框类型
   - 设置会立即应用

## 注意事项

1. **选区支持**：
   - 单个单元格：应用到当前单元格
   - 多个单元格：应用到整个选区

2. **边框叠加**：
   - 相邻单元格的边框会叠加显示
   - 后设置的边框会覆盖之前的设置

3. **菜单自动关闭**：
   - 选择边框类型后，菜单自动关闭
   - 点击菜单外部也会关闭菜单

4. **暗黑模式**：
   - 边框菜单会自动适配系统的暗黑模式
   - 边框颜色选择器在任何主题下都可正常使用

## 测试覆盖

边框功能已包含完整的单元测试（11 个测试用例）：

- ✅ 渲染边框按钮
- ✅ 点击显示/隐藏菜单
- ✅ 显示所有边框选项
- ✅ 所有边框功能
- ✅ 外边框功能
- ✅ 清除边框功能
- ✅ 边框样式切换
- ✅ 边框颜色切换
- ✅ 单个单元格边框设置
- ✅ 选项点击后关闭菜单
- ✅ 单边边框正确设置

所有测试 100% 通过，确保功能稳定可靠。

## 后续计划

- [ ] 添加更多边框样式（如波浪线、双虚线等）
- [ ] 支持边框预设模板
- [ ] 支持快捷键设置边框
- [ ] 边框样式预览功能
