# ğŸ¨ å•å…ƒæ ¼æ ·å¼å¿«é€Ÿå‚è€ƒ

## ğŸ“¦ CellStyle æ¥å£

```typescript
interface CellStyle {
  // å­—ä½“
  fontFamily?: string          // 'Arial', 'Microsoft YaHei', etc.
  fontSize?: number            // 9-72 (px)
  
  // æ ·å¼
  bold?: boolean
  italic?: boolean
  underline?: boolean | 'single' | 'double'
  strikethrough?: boolean
  
  // é¢œè‰²
  color?: string               // '#000000' æˆ– 'rgb(0,0,0)'
  backgroundColor?: string     // '#FFFFFF' æˆ– 'rgb(255,255,255)'
  
  // å¯¹é½
  textAlign?: 'left' | 'center' | 'right'
  verticalAlign?: 'top' | 'middle' | 'bottom'
  
  // é«˜çº§
  wrapText?: boolean           // è‡ªåŠ¨æ¢è¡Œ
  textRotation?: number        // 0-360 åº¦
}
```

## ğŸ”§ API ä½¿ç”¨

```typescript
// 1. è®¾ç½®å•ä¸ªå•å…ƒæ ¼æ ·å¼
api.setCellStyle(0, 0, {
  bold: true,
  fontSize: 16,
  color: '#FF0000'
})

// 2. è·å–å•å…ƒæ ¼æ ·å¼
const style = api.getCellStyle(0, 0)

// 3. æ‰¹é‡è®¾ç½®ï¼ˆé€‰åŒºï¼‰
api.setRangeStyle(0, 0, 5, 5, {
  backgroundColor: '#FFFF00'
})

// 4. æ¸…é™¤æ ·å¼
api.clearCellStyle(0, 0)

// 5. å¿«æ·æ–¹æ³•
api.setBold(0, 0, true)
api.setItalic(0, 0, true)
api.setFontSize(0, 0, 16)
api.setTextColor(0, 0, '#FF0000')
api.setBackgroundColor(0, 0, '#FFFF00')
api.setTextAlign(0, 0, 'center')
```

## âŒ¨ï¸ å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ | çŠ¶æ€ |
|--------|------|------|
| Ctrl+B | ç²—ä½“ | Day 4 |
| Ctrl+I | æ–œä½“ | Day 4 |
| Ctrl+U | ä¸‹åˆ’çº¿ | Day 4 |

## ğŸ¨ Canvas æ¸²æŸ“å…³é”®ç‚¹

### å­—ä½“å­—ç¬¦ä¸²
```typescript
// "italic bold 16px Arial, sans-serif"
ctx.font = `${italic ? 'italic ' : ''}${bold ? 'bold ' : ''}${fontSize}px ${fontFamily}`
```

### æ–‡æœ¬å¯¹é½
```typescript
// æ°´å¹³
ctx.textAlign = 'left' | 'center' | 'right'

// å‚ç›´
ctx.textBaseline = 'top' | 'middle' | 'bottom'
```

### ä¸‹åˆ’çº¿/åˆ é™¤çº¿
```typescript
// æ‰‹åŠ¨ç»˜åˆ¶çº¿æ¡
ctx.beginPath()
ctx.moveTo(x, y)
ctx.lineTo(x + width, y)
ctx.stroke()
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–æŠ€å·§

1. **æ ·å¼ç¼“å­˜**: ä½¿ç”¨ Map å­˜å‚¨ï¼Œé¿å…å¯¹è±¡éå†
2. **å­—ä½“å­—ç¬¦ä¸²ç¼“å­˜**: ç›¸åŒæ ·å¼å¤ç”¨å­—ç¬¦ä¸²
3. **æ‰¹é‡ç»˜åˆ¶**: ç›¸åŒæ ·å¼çš„å•å…ƒæ ¼ä¸€èµ·ç»˜åˆ¶
4. **measureText ç¼“å­˜**: æ–‡æœ¬å®½åº¦æµ‹é‡ç»“æœç¼“å­˜

## ğŸ§ª æµ‹è¯•é‡ç‚¹

```typescript
// 1. æ ·å¼è®¾ç½®ä¸è·å–
expect(model.getCellStyle(0, 0).bold).toBe(true)

// 2. æ ·å¼åˆå¹¶ï¼ˆä¸è¦†ç›–ï¼‰
model.setCellStyle(0, 0, { bold: true })
model.setCellStyle(0, 0, { italic: true })
expect(style.bold && style.italic).toBe(true)

// 3. æ‰¹é‡æ“ä½œ
model.setRangeStyle(0, 0, 2, 2, { color: '#FF0000' })
expect(model.getCellStyle(1, 1).color).toBe('#FF0000')

// 4. æ¸…é™¤æ ·å¼
model.clearCellStyle(0, 0)
expect(model.getCellStyle(0, 0)).toEqual(DEFAULT_CELL_STYLE)
```

## ğŸ“ å¸¸ç”¨å­—ä½“

```typescript
const commonFonts = [
  'Arial, sans-serif',
  "'Microsoft YaHei', sans-serif",  // å¾®è½¯é›…é»‘
  "'SimSun', serif",                 // å®‹ä½“
  "'SimHei', sans-serif",            // é»‘ä½“
  "'KaiTi', serif",                  // æ¥·ä½“
  "'FangSong', serif",               // ä»¿å®‹
  'Courier New, monospace',
  'Times New Roman, serif'
]

const fontSizes = [9, 10, 11, 12, 14, 16, 18, 20, 24, 28, 32, 36, 48, 72]
```

## ğŸ¯ æ¯æ—¥ç›®æ ‡é€ŸæŸ¥

- **Day 1**: æ•°æ®ç»“æ„ â†’ `types.ts` + `SheetModel.ts`
- **Day 2**: åŸºç¡€æ¸²æŸ“ â†’ å­—ä½“ã€é¢œè‰²ã€è£…é¥°
- **Day 3**: é«˜çº§åŠŸèƒ½ â†’ å¯¹é½ã€èƒŒæ™¯ã€æ¢è¡Œã€æ—‹è½¬
- **Day 4**: API + UI â†’ å·¥å…·æ ã€å¿«æ·é”®ã€æ’¤é”€é‡åš
- **Day 5**: æµ‹è¯•ä¼˜åŒ– â†’ å•å…ƒæµ‹è¯•ã€æ€§èƒ½ã€æ–‡æ¡£

---

**æ–‡ä»¶ä½ç½®**: æ‰“å°æˆ–æ”¾åœ¨æ˜¾ç¤ºå™¨æ—è¾¹éšæ—¶æŸ¥çœ‹  
**è¯¦ç»†è®¡åˆ’**: `docs/P0.1-CELL-STYLES-PLAN.md`  
**æ£€æŸ¥æ¸…å•**: `docs/P0.1-CHECKLIST.md`
